{
  "name": "whatsapp agent",
  "nodes": [
    {
      "parameters": {
        "options": { "systemMessage": "You are a helpful assistant" }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2.2,
      "position": [-384, 16],
      "id": "8c1ddbb1-896e-4419-a722-082cfe900f51",
      "name": "AI Agent"
    },
    {
      "parameters": { "modelName": "models/gemma-3-12b-it", "options": {} },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [-768, 320],
      "id": "a620dff8-2549-48fd-b8ca-355f57852712",
      "name": "Google Gemini Chat Model",
      "credentials": {
        "googlePalmApi": {
          "id": "EtxPcF58f1B6Qy8w",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": { "tableName": "Whatsapp_chat_histories" },
      "type": "@n8n/n8n-nodes-langchain.memoryPostgresChat",
      "typeVersion": 1.3,
      "position": [-384, 320],
      "id": "4b7fc304-3d8d-4461-91d4-5a69bd688ae1",
      "name": "Postgres Chat Memory",
      "credentials": {
        "postgres": { "id": "AdoxKouSceLdxn8C", "name": "Postgres account" }
      }
    },
    {
      "parameters": {
        "operation": "download",
        "fileId": {
          "__rl": true,
          "value": "1KMn6UUQgiOqlXtYSKN2xKrmyxDa21Ii0",
          "mode": "list",
          "cachedResultName": "FAQ for my company.docx",
          "cachedResultUrl": "https://docs.google.com/document/d/1KMn6UUQgiOqlXtYSKN2xKrmyxDa21Ii0/edit?usp=drivesdk&ouid=111023583954432515054&rtpof=true&sd=true"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleDriveTool",
      "typeVersion": 3,
      "position": [-224, 320],
      "id": "1234326a-be7e-4ad3-98bd-22cab80796ec",
      "name": "Download file in Google Drive",
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "gMXgMPpedb7PZh3J",
          "name": "Google Drive account 3"
        }
      }
    },
    {
      "parameters": { "model": "mxbai-embed-large:latest" },
      "type": "@n8n/n8n-nodes-langchain.embeddingsOllama",
      "typeVersion": 1,
      "position": [-144, 544],
      "id": "95febed6-9d17-4f5c-91b8-9b9db3447aaa",
      "name": "Embeddings Ollama",
      "credentials": {
        "ollamaApi": {
          "id": "xHuYe0MDGOs9IpBW",
          "name": "Local Ollama service"
        }
      }
    },
    {
      "parameters": {
        "inputText": "Whats mot in the agents parameters so it cant answer",
        "categories": {
          "categories": [{ "category": "human" }, { "category": "agent" }]
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.textClassifier",
      "typeVersion": 1.1,
      "position": [16, 16],
      "id": "be856ab7-704f-4b78-8b23-d9f344db8152",
      "name": "Text Classifier"
    },
    {
      "parameters": { "options": {} },
      "type": "@n8n/n8n-nodes-langchain.lmChatOllama",
      "typeVersion": 1,
      "position": [32, 192],
      "id": "81343536-f625-4319-94ae-443aa98157ff",
      "name": "Ollama Chat Model",
      "credentials": {
        "ollamaApi": {
          "id": "xHuYe0MDGOs9IpBW",
          "name": "Local Ollama service"
        }
      }
    },
    {
      "parameters": {
        "operation": "send",
        "recipientPhoneNumber": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Recipient_s_Phone_Number', ``, 'string') }}",
        "textBody": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Text_Body', ``, 'string') }}",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.whatsAppTool",
      "typeVersion": 1,
      "position": [1536, 336],
      "id": "5cb77943-f38d-4c7e-a786-449eb20a7402",
      "name": "Send message in WhatsApp Business Cloud",
      "webhookId": "138c7cd8-a1b2-496b-a407-9ec7211aa2f7"
    },
    {
      "parameters": { "operation": "__CUSTOM_API_CALL__" },
      "type": "n8n-nodes-base.googleDriveTool",
      "typeVersion": 3,
      "position": [-528, 336],
      "id": "39f7b9aa-b9c1-492d-89b0-c38aaa673d61",
      "name": "__CUSTOM_API_CALL__ file in Google Drive",
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "gMXgMPpedb7PZh3J",
          "name": "Google Drive account 3"
        }
      }
    },
    {
      "parameters": { "options": {} },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2.2,
      "position": [1232, 16],
      "id": "d9581cf8-9b98-4029-9077-b03f1bca6d36",
      "name": "AI Agent1"
    },
    {
      "parameters": {},
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "typeVersion": 1.3,
      "position": [1296, 336],
      "id": "08d94148-1983-45a6-aa58-dde922144de6",
      "name": "Simple Memory"
    },
    {
      "parameters": { "options": {} },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [1088, 352],
      "id": "2484aad1-15b0-4971-99ad-19c1466160b2",
      "name": "Gemini 2.5 flash",
      "credentials": {
        "googlePalmApi": {
          "id": "EtxPcF58f1B6Qy8w",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": {
        "mode": "retrieve-as-tool",
        "toolDescription": "Add information about enquiries in the databse for future analysis.",
        "qdrantCollection": {
          "__rl": true,
          "value": "Whatsapp questions and enquiries\n",
          "mode": "id"
        },
        "options": {
          "searchFilterJson": "{\n \"should\": [\n {\n \"key\": \"metadata.batch\",\n \"match\": {\n \"value\": 12345\n }\n }\n ]\n}"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStoreQdrant",
      "typeVersion": 1.3,
      "position": [-80, 352],
      "id": "2c05317b-ea23-41cd-8968-29212ea172cb",
      "name": "Qdrant Vector Store1",
      "credentials": {
        "qdrantApi": {
          "id": "sFfERYppMeBnFNeA",
          "name": "Local QdrantApi database"
        }
      }
    },
    {
      "parameters": { "updates": ["messages"], "options": {} },
      "type": "n8n-nodes-base.whatsAppTrigger",
      "typeVersion": 1,
      "position": [-576, 16],
      "id": "76dadc89-5a6f-40a9-b3d1-afe8621d03ec",
      "name": "WhatsApp Trigger",
      "webhookId": "8a7669a7-9a66-4700-abd6-8b2741663dd1"
    },
    {
      "parameters": { "operation": "sendAndWait", "options": {} },
      "type": "n8n-nodes-base.whatsApp",
      "typeVersion": 1,
      "position": [544, -96],
      "id": "39212ec3-6be5-42bf-826b-e05347d81d87",
      "name": "Send message and wait for response",
      "webhookId": "95318a33-2dd3-4acc-87b7-3834e2975b20",
      "credentials": {
        "whatsAppApi": { "id": "b3U9pcxlegviIaL5", "name": "WhatsApp account" }
      }
    }
  ],
  "pinData": {},
  "connections": {
    "Google Gemini Chat Model": {
      "ai_languageModel": [
        [{ "node": "AI Agent", "type": "ai_languageModel", "index": 0 }]
      ]
    },
    "Postgres Chat Memory": {
      "ai_memory": [[{ "node": "AI Agent", "type": "ai_memory", "index": 0 }]]
    },
    "Download file in Google Drive": {
      "ai_tool": [[{ "node": "AI Agent", "type": "ai_tool", "index": 0 }]]
    },
    "Embeddings Ollama": {
      "ai_embedding": [
        [{ "node": "Qdrant Vector Store1", "type": "ai_embedding", "index": 0 }]
      ]
    },
    "AI Agent": {
      "main": [[{ "node": "Text Classifier", "type": "main", "index": 0 }]]
    },
    "Ollama Chat Model": {
      "ai_languageModel": [
        [{ "node": "Text Classifier", "type": "ai_languageModel", "index": 0 }]
      ]
    },
    "Send message in WhatsApp Business Cloud": {
      "ai_tool": [[{ "node": "AI Agent1", "type": "ai_tool", "index": 0 }]]
    },
    "Text Classifier": {
      "main": [
        [
          {
            "node": "Send message and wait for response",
            "type": "main",
            "index": 0
          }
        ],
        [{ "node": "AI Agent1", "type": "main", "index": 0 }]
      ]
    },
    "__CUSTOM_API_CALL__ file in Google Drive": {
      "ai_tool": [[{ "node": "AI Agent", "type": "ai_tool", "index": 0 }]]
    },
    "Simple Memory": {
      "ai_memory": [[{ "node": "AI Agent1", "type": "ai_memory", "index": 0 }]]
    },
    "Gemini 2.5 flash": {
      "ai_languageModel": [
        [{ "node": "AI Agent1", "type": "ai_languageModel", "index": 0 }]
      ]
    },
    "Qdrant Vector Store1": {
      "ai_tool": [[{ "node": "AI Agent", "type": "ai_tool", "index": 0 }]]
    },
    "WhatsApp Trigger": {
      "main": [[{ "node": "AI Agent", "type": "main", "index": 0 }]]
    },
    "Send message and wait for response": {
      "main": [[{ "node": "AI Agent1", "type": "main", "index": 0 }]]
    }
  },
  "active": false,
  "settings": { "executionOrder": "v1" },
  "versionId": "c92e439a-8390-414d-bfd1-48ac97ac40c8",
  "meta": {
    "instanceId": "558d88703fb65b2d0e44613bc35916258b0f0bf983c5d4730c00c424b77ca36a"
  },
  "id": "2KjYdoQHp5OiYIqS",
  "tags": []
}
